{
  "openapi": "3.0.0",
  "info": {
    "title": "Gateway API",
    "version": "1.0.0",
    "description": "Position Pal Gateway API"
  },
  "paths": {
    "/auth/login": {
      "post": {
        "summary": "Logs in a user",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "username": {
                    "type": "string",
                    "example": "mario.rossi@gmail.com"
                  },
                  "password": {
                    "type": "string",
                    "example": "w0nd3rfulApp!@"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully logged in",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "date": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "token": {
                          "type": "string",
                          "example": "..."
                        }
                      }
                    },
                    "code": {
                      "type": "integer",
                      "example": 200
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Malformed request body"
          },
          "401": {
            "description": "Invalid credentials"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/auth/authorize": {
      "post": {
        "summary": "Authorizes a user",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": {
                    "type": "string",
                    "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxMjM0NTY3ODkwLCJpYXQiOjE2MjMwODk4NzIsImV4cCI6MTYyMzA5MzQ3Mn0.PK9Cm1_vD5hH2pDZqR5Jkv25e19CgihUE8-jf3k2c-w"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully authorized"
          },
          "400": {
            "description": "Malformed request body"
          },
          "401": {
            "description": "Invalid token"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/auth/authorizeUserToAccessGroup": {
      "post": {
        "summary": "Authorizes a user to access a group",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": {
                    "type": "string",
                    "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxMjM0NTY3ODkwLCJpYXQiOjE2MjMwODk4NzIsImV4cCI6MTYyMzA5MzQ3Mn0.PK9Cm1_vD5hH2pDZqR5Jkv25e19CgihUE8-jf3k2c-w"
                  },
                  "groupId": {
                    "type": "string",
                    "example": "3428020f-2332-4d67-9031-98f636a55ce5"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully authorized user"
          },
          "401": {
            "description": "Authorization failed"
          }
        }
      }
    },
    "/notification/register": {
      "post": {
        "summary": "Registers a device token in order to receive notifications",
        "tags": [
          "Notification"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "user": {
                    "type": "string",
                    "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
                  },
                  "token": {
                    "type": "string",
                    "example": "fcm_token_example_1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully registered token",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "date": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "message": {
                          "type": "string",
                          "example": "Token successfully registered"
                        }
                      }
                    },
                    "code": {
                      "type": "integer",
                      "example": 200
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Malformed request body"
          },
          "409": {
            "description": "Token already registered"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/notification/invalidate": {
      "post": {
        "summary": "Invalidates a notification token",
        "tags": [
          "Notification"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "user": {
                    "type": "string",
                    "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
                  },
                  "token": {
                    "type": "string",
                    "example": "some_device_token"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully invalidated token",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "date": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "message": {
                          "type": "string",
                          "example": "Token successfully invalidated"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Malformed request body"
          },
          "404": {
            "description": "Token not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/session/{group}": {
      "get": {
        "summary": "Get the current session for a group",
        "tags": [
          "Session"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "group",
            "required": true,
            "schema": {
              "type": "string",
              "example": "3428020f-2332-4d67-9031-98f636a55ce5"
            },
            "description": "The group ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved session",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "date": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "session": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "scope": {
                                "type": "object",
                                "properties": {
                                  "user": {
                                    "type": "object",
                                    "properties": {
                                      "value": {
                                        "type": "string",
                                        "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
                                      }
                                    }
                                  },
                                  "group": {
                                    "type": "object",
                                    "properties": {
                                      "value": {
                                        "type": "string",
                                        "example": "3428020f-2332-4d67-9031-98f636a55ce5"
                                      }
                                    }
                                  }
                                }
                              },
                              "state": {
                                "type": "string",
                                "example": "ACTIVE"
                              },
                              "lastSampledLocation": {
                                "type": "object",
                                "properties": {
                                  "user": {
                                    "type": "object",
                                    "properties": {
                                      "value": {
                                        "type": "string",
                                        "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
                                      }
                                    }
                                  },
                                  "timestamp": {
                                    "type": "object",
                                    "properties": {
                                      "seconds": {
                                        "type": "number",
                                        "example": 1630000000
                                      },
                                      "nanos": {
                                        "type": "number",
                                        "example": 0
                                      }
                                    }
                                  },
                                  "location": {
                                    "type": "object",
                                    "properties": {
                                      "latitude": {
                                        "type": "number",
                                        "example": 37.7749
                                      },
                                      "longitude": {
                                        "type": "number",
                                        "example": -122.4194
                                      }
                                    }
                                  }
                                }
                              },
                              "activeTracking": {
                                "type": "object",
                                "properties": {
                                  "route": {
                                    "type": "object",
                                    "properties": {
                                      "locations": {
                                        "type": "array",
                                        "items": {
                                          "type": "object",
                                          "properties": {
                                            "user": {
                                              "type": "object",
                                              "properties": {
                                                "value": {
                                                  "type": "string",
                                                  "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
                                                }
                                              }
                                            },
                                            "location": {
                                              "type": "object",
                                              "properties": {
                                                "latitude": {
                                                  "type": "number",
                                                  "example": 37.7749
                                                },
                                                "longitude": {
                                                  "type": "number",
                                                  "example": -122.4194
                                                }
                                              }
                                            },
                                            "timestamp": {
                                              "type": "object",
                                              "properties": {
                                                "seconds": {
                                                  "type": "number",
                                                  "example": 1630000000
                                                },
                                                "nanos": {
                                                  "type": "number",
                                                  "example": 0
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  },
                                  "destination": {
                                    "type": "object",
                                    "properties": {
                                      "name": {
                                        "type": "string",
                                        "example": "St. Peter's Basilica, Vatican City, Italy"
                                      },
                                      "location": {
                                        "type": "object",
                                        "properties": {
                                          "latitude": {
                                            "type": "number",
                                            "example": 41.9022
                                          },
                                          "longitude": {
                                            "type": "number",
                                            "example": 12.4533
                                          }
                                        }
                                      }
                                    }
                                  },
                                  "eta": {
                                    "type": "object",
                                    "properties": {
                                      "seconds": {
                                        "type": "number",
                                        "example": 1630000000
                                      },
                                      "nanos": {
                                        "type": "number",
                                        "example": 0
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Session not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/session/location/{group}/{user}": {
      "get": {
        "summary": "Get the current location for a user in a group",
        "tags": [
          "Session"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "group",
            "required": true,
            "schema": {
              "type": "string",
              "example": "3428020f-2332-4d67-9031-98f636a55ce5"
            },
            "description": "The group ID"
          },
          {
            "in": "path",
            "name": "user",
            "required": true,
            "schema": {
              "type": "string",
              "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
            },
            "description": "The user ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved location",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "date": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "location": {
                          "type": "object",
                          "properties": {
                            "latitude": {
                              "type": "number",
                              "example": 37.7749
                            },
                            "longitude": {
                              "type": "number",
                              "example": -122.4194
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "User in specified group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/session/state/{group}/{user}": {
      "get": {
        "summary": "Get the current state for a user in a group",
        "tags": [
          "Session"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "group",
            "required": true,
            "schema": {
              "type": "string",
              "example": "3428020f-2332-4d67-9031-98f636a55ce5"
            },
            "description": "The group ID"
          },
          {
            "in": "path",
            "name": "user",
            "required": true,
            "schema": {
              "type": "string",
              "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
            },
            "description": "The user ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved state",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "date": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "status": {
                          "type": "string",
                          "example": "ACTIVE"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "User in specified group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/session/tracking/{group}/{user}": {
      "get": {
        "summary": "Get the current tracking information for a user in a group",
        "tags": [
          "Session"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "group",
            "required": true,
            "schema": {
              "type": "string",
              "example": "3428020f-2332-4d67-9031-98f636a55ce5"
            },
            "description": "The group ID"
          },
          {
            "in": "path",
            "name": "user",
            "required": true,
            "schema": {
              "type": "string",
              "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
            },
            "description": "The user ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved tracking information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "date": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "route": {
                          "type": "object",
                          "properties": {
                            "locations": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "user": {
                                    "type": "object",
                                    "properties": {
                                      "value": {
                                        "type": "string",
                                        "example": "851c6d72-f5ee-4ae2-afa2-6fa914dcb57e"
                                      }
                                    }
                                  },
                                  "location": {
                                    "type": "object",
                                    "description": "The location of the user",
                                    "properties": {
                                      "latitude": {
                                        "type": "number",
                                        "example": 37.7749
                                      },
                                      "longitude": {
                                        "type": "number",
                                        "example": -122.4194
                                      }
                                    }
                                  },
                                  "timestamp": {
                                    "type": "object",
                                    "properties": {
                                      "seconds": {
                                        "type": "number",
                                        "example": 1630000000
                                      },
                                      "nanos": {
                                        "type": "number",
                                        "example": 0
                                      }
                                    }
                                  }
                                }
                              }
                            },
                            "destination": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string",
                                  "example": "St. Peter's Basilica, Vatican City, Italy"
                                },
                                "location": {
                                  "type": "object",
                                  "properties": {
                                    "latitude": {
                                      "type": "number",
                                      "example": 41.9022
                                    },
                                    "longitude": {
                                      "type": "number",
                                      "example": 12.4533
                                    }
                                  }
                                }
                              }
                            },
                            "eta": {
                              "type": "object",
                              "properties": {
                                "seconds": {
                                  "type": "number",
                                  "example": 1630000000
                                },
                                "nanos": {
                                  "type": "number",
                                  "example": 0
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "User in specified group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    }
  },
  "components": {},
  "tags": []
}